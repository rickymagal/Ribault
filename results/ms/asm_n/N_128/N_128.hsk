-- Merge Sort in the subset of the compiled functional language

-- Merge two sorted lists into a single sorted list
merge xs ys = case xs of
    [] -> ys;
    (x:xt) -> case ys of
        [] -> xs;
        (y:yt) -> if x <= y
                  then x : merge xt ys
                  else y : merge xs yt;;
;
-- Split a list into two approximately equal halves
split lst = case lst of
  []   -> ([], []);
  [x]  -> ([x], []);
  x:y:zs ->
    case split zs of
      (xs, ys) -> (x:xs, y:ys);;
;


-- Merge Sort function
mergeSort lst = case lst of
    [] -> [];
    (x:[]) -> [x];
    _ -> case split lst of
           (left, right) -> merge (mergeSort left) (mergeSort right);;
;
-- Main expression for testing
main = mergeSort [[670487,116739,26225,777572,288389,256787,234053,146316,772246,107473,709570,776646,935518,571858,91161,619176,442417,33326,31244,98246,229258,243962,529903,631262,27824,588508,208496,750800,681453,735392,571412,439898,231148,471029,617889,291704,848749,911527,6814,795667,844962,167414,732052,443143,356778,291369,163032,225772,800581,352944,107175,97251,398382,101414,376417,888662,360663,633052,277370,846335,45561,765179,481741,562275,130889,967096,396922,82627,578856,307419,869693,659176,648564,928463,903565,379201,605397,201629,738797,72933,48050,693384,238968,810620,303445,83667,896865,244098,908573,105907,398591,291476,475435,666563,874628,382554,170555,388162,372528,219684,702729,279946,735911,982153,716751,679514,74870,638720,665822,179451,560086,764544,256702,171339,484714,397887,283060,970342,671088,721590,584004,230283,717870,340035,883794,805635,813694,58655]]