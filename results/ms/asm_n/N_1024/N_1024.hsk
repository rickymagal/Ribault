-- Merge Sort in the subset of the compiled functional language

-- Merge two sorted lists into a single sorted list
merge xs ys = case xs of
    [] -> ys;
    (x:xt) -> case ys of
        [] -> xs;
        (y:yt) -> if x <= y
                  then x : merge xt ys
                  else y : merge xs yt;;
;
-- Split a list into two approximately equal halves
split lst = case lst of
  []   -> ([], []);
  [x]  -> ([x], []);
  x:y:zs ->
    case split zs of
      (xs, ys) -> (x:xs, y:ys);;
;


-- Merge Sort function
mergeSort lst = case lst of
    [] -> [];
    (x:[]) -> [x];
    _ -> case split lst of
           (left, right) -> merge (mergeSort left) (mergeSort right);;
;
-- Main expression for testing
main = mergeSort [[670487,116739,26225,777572,288389,256787,234053,146316,772246,107473,709570,776646,935518,571858,91161,619176,442417,33326,31244,98246,229258,243962,529903,631262,27824,588508,208496,750800,681453,735392,571412,439898,231148,471029,617889,291704,848749,911527,6814,795667,844962,167414,732052,443143,356778,291369,163032,225772,800581,352944,107175,97251,398382,101414,376417,888662,360663,633052,277370,846335,45561,765179,481741,562275,130889,967096,396922,82627,578856,307419,869693,659176,648564,928463,903565,379201,605397,201629,738797,72933,48050,693384,238968,810620,303445,83667,896865,244098,908573,105907,398591,291476,475435,666563,874628,382554,170555,388162,372528,219684,702729,279946,735911,982153,716751,679514,74870,638720,665822,179451,560086,764544,256702,171339,484714,397887,283060,970342,671088,721590,584004,230283,717870,340035,883794,805635,813694,58655,240174,861722,33659,844151,330776,420651,280746,69403,221231,957492,988712,594731,918938,752787,329963,222955,687277,523481,414850,927657,958972,674079,481141,149811,277746,146413,258607,781177,588637,565158,275504,783300,612982,449245,941435,611878,418801,379580,229974,145051,534277,517488,95325,792495,49405,902931,114975,160265,657924,167753,830555,713536,442666,625380,66613,403457,400156,624834,490785,554816,263626,580099,902592,988210,12038,713328,755731,120116,714825,927767,563054,787352,279786,805934,672097,356699,116970,307757,455884,165840,475763,3402,757168,918398,754639,276183,524902,798975,187330,532342,956959,111579,912804,655674,312942,882554,669987,532323,638551,208573,160263,392077,799550,169396,565579,999816,816449,967242,556116,963110,599,628038,339902,512340,20422,117301,974230,380612,921406,872064,845964,322451,251083,60738,252572,920659,594916,992948,82582,89814,767460,509597,855662,72574,797549,558582,803035,131869,134628,691798,498369,992842,576510,173148,277932,553306,914812,636059,443692,222086,974036,565492,791952,765388,723378,210922,747581,326858,418373,704314,681446,391559,459381,943313,542717,473417,126882,259947,235612,67136,354508,22056,616886,580828,241292,617024,230914,7540,74441,742225,661759,61733,240062,70674,949401,32938,901393,346479,74299,539131,249565,292004,701474,508993,224643,565427,138739,758490,980957,925245,598782,604201,495631,254801,822733,495948,846721,426833,199659,98907,101639,690993,451989,371507,444154,431071,489710,905798,764491,56802,706073,685197,677568,103198,63556,422179,763587,355784,839482,903529,114576,260735,200896,199448,562336,470405,146991,442374,192401,292075,485100,261941,916964,968114,79046,464656,847272,903189,897546,577057,102664,53045,683823,566847,876638,15474,97793,971366,790170,889921,247861,174389,426156,509231,504740,224130,906651,420521,946279,61483,172634,397382,2260,409386,278085,971524,822157,823267,477110,299105,443555,730429,765990,821414,582765,694022,753305,510311,162316,199122,311120,228275,61324,607314,771476,568532,63918,784309,328838,59942,52578,612554,499948,527276,964047,894141,556926,165080,59642,532496,84002,892697,194851,71849,623939,71262,708011,903682,246629,423389,125710,987335,933533,597347,258175,607040,623398,41672,649468,85965,439589,689305,612024,592683,548177,331737,980110,273432,214181,702258,750981,329445,250280,278517,415011,137235,704318,676856,314569,479434,331535,974146,788387,981188,76066,9767,480547,651332,590341,104837,76819,563750,223508,530458,278082,138890,978593,365962,923653,72132,921981,256150,387477,298830,165409,459469,874244,569605,737715,317212,641390,846305,685743,554634,8203,700305,856795,581542,313921,977017,695613,108618,984539,920782,140814,277312,121035,932931,112235,778480,580097,162998,285577,295442,634210,220861,752470,359536,213487,720892,665046,894343,276807,529959,512262,263319,949314,952273,887204,53266,96781,665095,444151,869634,290120,46228,3717,349759,808577,137174,668061,274680,169430,777236,463298,578478,739945,448462,588153,10139,117308,78898,990957,926004,724586,947837,156294,572092,37778,875136,387151,610805,579364,155287,450664,133636,43860,323232,382364,942650,978413,834794,902512,41832,942590,375190,220281,715198,261650,699330,107786,370858,818011,587080,927082,917202,426117,650810,785884,162060,970733,975050,248237,906604,170395,838742,850155,185652,924231,432322,25990,188073,772343,969395,348321,820391,976031,431712,841204,702448,906036,770763,850132,260222,279766,166931,825622,735343,113346,401124,914533,40605,900300,493554,233238,209267,856253,963066,482662,366643,320015,860394,833980,913648,238651,233752,24813,692094,202511,417821,344207,292136,906339,72792,810891,292683,368203,672642,534150,419093,712526,884642,562262,347235,984861,28941,120944,919641,273903,187241,608792,278361,40115,113668,625550,455673,362479,763934,824629,328914,457592,635656,536265,121263,403906,943199,604596,199312,267095,46542,743215,457239,1773,545175,970535,845687,564607,720221,754377,985937,777991,772840,703204,206606,381913,452248,73372,994967,696503,965498,346239,653425,329164,695612,889208,130679,754717,943767,314910,531756,324308,699287,428231,342027,421947,731076,310016,581343,133470,201158,440869,697229,986042,397562,710219,784475,946660,182480,645414,596750,315568,425800,574553,874224,425,318635,300850,220392,450770,823927,608158,636130,686508,337902,487575,463246,463638,708446,224082,536004,496171,832291,944956,834692,771711,177934,690855,88914,297571,540490,696101,663686,649342,351470,97923,858179,998243,787625,246277,705477,325498,235552,845742,208802,154511,25611,48458,256736,498216,640967,891014,805819,76365,477538,434572,929181,660356,603634,203880,753240,730180,402630,518392,419066,255836,154739,687926,721024,5814,936021,787443,902237,807451,928477,111764,816232,445798,229471,184430,843170,729716,543118,487115,52657,584482,261303,962037,889545,127253,478634,139816,840346,487213,700005,556932,586075,624377,332711,996188,791937,934727,464071,642412,854596,754213,935351,529298,447470,870914,950906,574485,467574,940790,166889,779779,903342,497732,471932,271782,788295,259249,880660,668636,290782,803013,815451,546622,508136,657193,250867,287936,461239,81247,748206,299607,245884,284913,352161,335239,936406,566390,84491,145095,158157,242495,401641,727659,160227,740734,224345,67348,435020,427398,346954,568969,488557,435970,65290,216881,873349,440552,408396,948791,807189,612451,992017,729308,20480,898348,923435,802784,603655,398858,500149,6182,988536,368845,313118,790075,408930,894905,934953,999744,876325,439375,564365,783826,770319,572661,838722,632556,941423,231251,511945,230080,286193,457007,509232,30434,407746,352457,701364,712131,836912,423956,759359,173061,881334,490094,964209,133827,652483,560069,28276,950983,413160,620644,591807,695205,28418,88025,673971,449433,142291,908959,484125,190556,52727,272793,397519,343254,221941,476786,342722,353894,798207,922369,397542,291773,788539,997409,872335,442042,264525,875467,85884,493152,20324,785408,565621,54615,998160,366960,235113,681725,71951,819182,683414,42213,790870,32537,995740,259295,209044,879995,21369,651517,159784,250132,132352,496564,701978,119946,591364,993795,228552]]